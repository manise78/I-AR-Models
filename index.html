<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <title>Visualizzatore AR</title>
    <script type="module"
            src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
    </script>
    <style>
        body { margin: 0; }
        model-viewer { width: 100vw; height: 100vh; background: #f0f0f0; }
        button#arButton {
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: #007bff;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }
        .ar-button-container {
            position: absolute;
            bottom: 16px;
            right: 16px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <model-viewer id="viewer"
                  ar
                  ar-modes="webxr scene-viewer quick-look"
                  camera-controls
                  touch-action="pan-y"
                  shadow-intensity="1">
        <div class="ar-button-container" slot="ar-button">
            <button id="arButton">VEDI IN AR</button>
        </div>
    </model-viewer>

    <script>
        (function() {
            const params = new URLSearchParams(window.location.search);
            const model = params.get('model');

            if (!model) {
                alert('Nessun modello specificato.');
                return;
            }

            const viewer = document.getElementById('viewer');

            // URL completo del modello su GitHub Pages
            const modelUrl = `https://manise78.github.io/I-AR-Models/${model}?t=${Date.now()}`;
            viewer.src = modelUrl;

            // Eventuale fallback per errori di caricamento
            viewer.addEventListener('error', () => {
                alert('Impossibile caricare il modello: ' + model);
                console.error('Errore caricamento modello', modelUrl);
            });

            // AR Button funziona automaticamente grazie a <model-viewer>
            // Nessuna azione JS aggiuntiva richiesta
        })();
    </script>
</body>
</html>
