<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <title>Visualizzatore AR</title>
    <script type="module"
            src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
    </script>
    <style>
        body{margin:0;}
        model-viewer{width:100vw;height:100vh;background:#f0f0f0;}
    </style>
</head>
<body>
    <model-viewer id="viewer"
                  ar
                  ar-modes="webxr scene-viewer quick-look"
                  camera-controls
                  touch-action="pan-y"
                  shadow-intensity="1">
        <div slot="ar-button"
             style="position:absolute;bottom:16px;right:16px;">
            <button style="
                padding:12px;
                border-radius:8px;
                border:none;
                background:#007bff;
                color:white;
                font-weight:bold;">
                VEDI IN AR
            </button>
        </div>
    </model-viewer>

    <script>
(async function () {

    const params = new URLSearchParams(window.location.search);
    const model = params.get('model');

    if (!model) {
        alert('Nessun modello specificato.');
        return;
    }

    const viewer = document.getElementById('viewer');

    try {
        const response = await fetch('./' + model + '?t=' + Date.now());
        if (!response.ok) throw new Error("Errore HTTP");

        const blob = await response.blob();
        const blobUrl = URL.createObjectURL(blob);

        viewer.src = blobUrl;

    } catch (err) {
        alert('Impossibile scaricare il modello ' + model);
        console.error(err);
    }

})();
</script>
    
</body>
</html>
