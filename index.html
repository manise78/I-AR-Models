<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <title>Visualizzatore AR</title>
    <script type="module"
            src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
    </script>
    <style>
        body { margin: 0; }
        model-viewer { width: 100vw; height: 100vh; background: #f0f0f0; }
        .ar-button-container {
            position: absolute;
            bottom: 16px;
            right: 16px;
            z-index: 10;
        }
        #arButton {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            background: #007bff;
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<model-viewer id="viewer"
              ar
              ar-modes="webxr scene-viewer quick-look"
              camera-controls
              touch-action="pan-y"
              shadow-intensity="1">
    <div slot="ar-button" class="ar-button-container">
        <button id="arButton">VEDI IN AR</button>
    </div>
</model-viewer>

<script type="module">
import '@google/model-viewer/dist/model-viewer.min.js';
</script>

<script>
(() => {
  const params = new URLSearchParams(window.location.search);
  const modelFile = params.get('model');

  if (!modelFile) {
    alert('Nessun modello specificato.');
    return;
  }

  const viewer = document.getElementById('viewer');

  // URL assoluto: /I-AR-Models/nomefile.glb
  const base = `${window.location.origin}/I-AR-Models/`;
  const modelUrl = `${base}${modelFile}?t=${Date.now()}`;

  viewer.src = modelUrl;

  viewer.addEventListener('error', () => {
    alert('Impossibile caricare il modello: ' + modelFile);
    console.error('Errore caricamento modello', modelUrl);
  });
})();
</script>

</body>
</html>
